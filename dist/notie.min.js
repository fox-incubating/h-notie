const positions={top:"top",bottom:"bottom"};let options={alertTime:3,dateMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],overlayClickDismiss:!0,overlayOpacity:.75,transitionCurve:"ease",transitionDuration:.3,transitionSelector:"all",classes:{container:"notie-container",textbox:"notie-textbox",textboxInner:"notie-textbox-inner",button:"notie-button",element:"notie-element",elementHalf:"notie-element-half",elementThird:"notie-element-third",overlay:"notie-overlay",backgroundSuccess:"notie-background-success",backgroundWarning:"notie-background-warning",backgroundError:"notie-background-error",backgroundInfo:"notie-background-info",backgroundNeutral:"notie-background-neutral",backgroundOverlay:"notie-background-overlay",alert:"notie-alert",inputField:"notie-input-field",selectChoiceRepeated:"notie-select-choice-repeated",dateSelectorInner:"notie-date-selector-inner",dateSelectorUp:"notie-date-selector-up"},ids:{overlay:"notie-overlay"},positions:{alert:positions.top,force:positions.top,confirm:positions.top,input:positions.top,select:positions.bottom,date:positions.top}};export const setOptions=e=>{options={...options,...e,classes:{...options.classes,...e.classes},ids:{...options.ids,...e.ids},positions:{...options.positions,...e.positions}}};const tick=()=>new Promise((e=>setTimeout(e,0))),wait=e=>new Promise((t=>setTimeout(t,1e3*e))),blur=()=>{document.activeElement&&document.activeElement.blur()},generateRandomId=()=>`notie-${"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}`,typeToClassLookup={1:options.classes.backgroundSuccess,success:options.classes.backgroundSuccess,2:options.classes.backgroundWarning,warning:options.classes.backgroundWarning,3:options.classes.backgroundError,error:options.classes.backgroundError,4:options.classes.backgroundInfo,info:options.classes.backgroundInfo,5:options.classes.backgroundNeutral,neutral:options.classes.backgroundNeutral},getTransition=()=>`${options.transitionSelector} ${options.transitionDuration}s ${options.transitionCurve}`,enterClicked=e=>13===e.keyCode,escapeClicked=e=>27===e.keyCode,addToDocument=(e,t)=>{e.classList.add(options.classes.container),e.style[t]="-10000px",document.body.appendChild(e),e.style[t]=`-${e.offsetHeight}px`,e.listener&&window.addEventListener("keydown",e.listener),tick().then((()=>{e.style.transition=getTransition(),e.style[t]=0}))},removeFromDocument=(e,t)=>{const s=document.getElementById(e);s&&(s.style[t]=`-${s.offsetHeight}px`,s.listener&&window.removeEventListener("keydown",s.listener),wait(options.transitionDuration).then((()=>{s.parentNode&&s.parentNode.removeChild(s)})))},addOverlayToDocument=(e,t)=>{const s=document.createElement("div");s.id=options.ids.overlay,s.classList.add(options.classes.overlay),s.classList.add(options.classes.backgroundOverlay),s.style.opacity=0,e&&options.overlayClickDismiss&&(s.onclick=()=>{removeFromDocument(e.id,t),removeOverlayFromDocument()}),document.body.appendChild(s),tick().then((()=>{s.style.transition=getTransition(),s.style.opacity=options.overlayOpacity}))},removeOverlayFromDocument=()=>{const e=document.getElementById(options.ids.overlay);e.style.opacity=0,wait(options.transitionDuration).then((()=>{e.parentNode&&e.parentNode.removeChild(e)}))};export const hideAlerts=e=>{const t=document.getElementsByClassName(options.classes.alert);if(t.length){for(let e=0;e<t.length;e++){const s=t[e];removeFromDocument(s.id,s.position)}e&&wait(options.transitionDuration).then((()=>e()))}};export const alert=({type:e=4,text:t,time:s=options.alertTime,stay:o=!1,position:n=options.positions.alert||n.top})=>{blur(),hideAlerts();const a=document.createElement("div"),i=generateRandomId();a.id=i,a.position=n,a.classList.add(options.classes.textbox),a.classList.add(typeToClassLookup[e]),a.classList.add(options.classes.alert),a.innerHTML=`<div class="${options.classes.textboxInner}">${t}</div>`,a.onclick=()=>removeFromDocument(i,n),a.listener=e=>{(enterClicked(e)||escapeClicked(e))&&hideAlerts()},addToDocument(a,n),s&&s<1&&(s=1),!o&&s&&wait(s).then((()=>removeFromDocument(i,n)))};export const force=({type:e=5,text:t,buttonText:s="OK",callback:o,position:n=options.positions.force||n.top},a)=>{blur(),hideAlerts();const i=document.createElement("div"),c=generateRandomId();i.id=c;const l=document.createElement("div");l.classList.add(options.classes.textbox),l.classList.add(options.classes.backgroundInfo),l.innerHTML=`<div class="${options.classes.textboxInner}">${t}</div>`;const d=document.createElement("div");d.classList.add(options.classes.button),d.classList.add(typeToClassLookup[e]),d.innerHTML=s,d.onclick=()=>{removeFromDocument(c,n),removeOverlayFromDocument(),o?o():a&&a()},i.appendChild(l),i.appendChild(d),i.listener=e=>{enterClicked(e)&&d.click()},addToDocument(i,n),addOverlayToDocument()};export const confirm=({text:e,submitText:t="Yes",cancelText:s="Cancel",submitCallback:o,cancelCallback:n,position:a=options.positions.confirm||a.top},i,c)=>{blur(),hideAlerts();const l=document.createElement("div"),d=generateRandomId();l.id=d;const r=document.createElement("div");r.classList.add(options.classes.textbox),r.classList.add(options.classes.backgroundInfo),r.innerHTML=`<div class="${options.classes.textboxInner}">${e}</div>`;const p=document.createElement("div");p.classList.add(options.classes.button),p.classList.add(options.classes.elementHalf),p.classList.add(options.classes.backgroundSuccess),p.innerHTML=t,p.onclick=()=>{removeFromDocument(d,a),removeOverlayFromDocument(),o?o():i&&i()};const u=document.createElement("div");u.classList.add(options.classes.button),u.classList.add(options.classes.elementHalf),u.classList.add(options.classes.backgroundError),u.innerHTML=s,u.onclick=()=>{removeFromDocument(d,a),removeOverlayFromDocument(),n?n():c&&c()},l.appendChild(r),l.appendChild(p),l.appendChild(u),l.listener=e=>{enterClicked(e)?p.click():escapeClicked(e)&&u.click()},addToDocument(l,a),addOverlayToDocument(l,a)};export const input=({text:e,submitText:t="Submit",cancelText:s="Cancel",submitCallback:o,cancelCallback:n,position:a=options.positions.input||a.top,...i},c,l)=>{blur(),hideAlerts();const d=document.createElement("div"),r=generateRandomId();d.id=r;const p=document.createElement("div");p.classList.add(options.classes.textbox),p.classList.add(options.classes.backgroundInfo),p.innerHTML=`<div class="${options.classes.textboxInner}">${e}</div>`;const u=document.createElement("input");u.classList.add(options.classes.inputField),u.setAttribute("autocapitalize",i.autocapitalize||"none"),u.setAttribute("autocomplete",i.autocomplete||"off"),u.setAttribute("autocorrect",i.autocorrect||"off"),u.setAttribute("autofocus",i.autofocus||"true"),u.setAttribute("inputmode",i.inputmode||"verbatim"),u.setAttribute("max",i.max||""),u.setAttribute("maxlength",i.maxlength||""),u.setAttribute("min",i.min||""),u.setAttribute("minlength",i.minlength||""),u.setAttribute("placeholder",i.placeholder||""),u.setAttribute("spellcheck",i.spellcheck||"default"),u.setAttribute("step",i.step||"any"),u.setAttribute("type",i.type||"text"),u.value=i.value||"",i.allowed&&(u.oninput=()=>{let e;if(Array.isArray(i.allowed)){let t="";const s=i.allowed;for(let e=0;e<s.length;e++)"an"===s[e]?t+="0-9a-zA-Z":"a"===s[e]?t+="a-zA-Z":"n"===s[e]&&(t+="0-9"),"s"===s[e]&&(t+=" ");e=new RegExp(`[^${t}]`,"g")}else"object"==typeof i.allowed&&(e=i.allowed);u.value=u.value.replace(e,"")});const m=document.createElement("div");m.classList.add(options.classes.button),m.classList.add(options.classes.elementHalf),m.classList.add(options.classes.backgroundSuccess),m.innerHTML=t,m.onclick=()=>{removeFromDocument(r,a),removeOverlayFromDocument(),o?o(u.value):c&&c(u.value)};const b=document.createElement("div");b.classList.add(options.classes.button),b.classList.add(options.classes.elementHalf),b.classList.add(options.classes.backgroundError),b.innerHTML=s,b.onclick=()=>{removeFromDocument(r,a),removeOverlayFromDocument(),n?n(u.value):l&&l(u.value)},d.appendChild(p),d.appendChild(u),d.appendChild(m),d.appendChild(b),d.listener=e=>{enterClicked(e)?m.click():escapeClicked(e)&&b.click()},addToDocument(d,a),u.focus(),addOverlayToDocument(d,a)};export const select=({text:e,cancelText:t="Cancel",cancelCallback:s,choices:o,position:n=options.positions.select||n.top},a)=>{blur(),hideAlerts();const i=document.createElement("div"),c=generateRandomId();i.id=c;const l=document.createElement("div");l.classList.add(options.classes.textbox),l.classList.add(options.classes.backgroundInfo),l.innerHTML=`<div class="${options.classes.textboxInner}">${e}</div>`,i.appendChild(l),o.forEach((({type:e=1,text:t,handler:s},a)=>{const l=document.createElement("div");l.classList.add(typeToClassLookup[e]),l.classList.add(options.classes.button),l.classList.add(options.classes.selectChoice);const d=o[a+1];d&&!d.type&&(d.type=1),d&&d.type===e&&l.classList.add(options.classes.selectChoiceRepeated),l.innerHTML=t,l.onclick=()=>{removeFromDocument(c,n),removeOverlayFromDocument(),s()},i.appendChild(l)}));const d=document.createElement("div");d.classList.add(options.classes.backgroundNeutral),d.classList.add(options.classes.button),d.innerHTML=t,d.onclick=()=>{removeFromDocument(c,n),removeOverlayFromDocument(),s?s():a&&a()},i.appendChild(d),i.listener=e=>{escapeClicked(e)&&d.click()},addToDocument(i,n),addOverlayToDocument(i,n)};export const date=({value:e=new Date,submitText:t="OK",cancelText:s="Cancel",submitCallback:o,cancelCallback:n,position:a=options.positions.date||a.top},i,c)=>{blur(),hideAlerts();const l="&#9662",d=document.createElement("div"),r=document.createElement("div"),p=document.createElement("div"),u=e=>{d.innerHTML=options.dateMonths[e.getMonth()],r.innerHTML=e.getDate(),p.innerHTML=e.getFullYear()},m=t=>{u(e)},b=t=>{const s=new Date(e.getFullYear(),e.getMonth()+t+1,0).getDate();e.getDate()>s&&e.setDate(s),e.setMonth(e.getMonth()+t),u(e)},v=t=>{e.setDate(e.getDate()+t),u(e)},L=t=>{e.getFullYear()+t<0?e.setFullYear(0):e.setFullYear(e.getFullYear()+t),u(e)},x=document.createElement("div"),k=generateRandomId();x.id=k;const g=document.createElement("div");g.classList.add(options.classes.backgroundInfo);const h=document.createElement("div");h.classList.add(options.classes.dateSelectorInner);const y=document.createElement("div");y.classList.add(options.classes.button),y.classList.add(options.classes.elementThird),y.classList.add(options.classes.dateSelectorUp),y.innerHTML=l;const C=document.createElement("div");C.classList.add(options.classes.button),C.classList.add(options.classes.elementThird),C.classList.add(options.classes.dateSelectorUp),C.innerHTML=l;const T=document.createElement("div");T.classList.add(options.classes.button),T.classList.add(options.classes.elementThird),T.classList.add(options.classes.dateSelectorUp),T.innerHTML=l,d.classList.add(options.classes.element),d.classList.add(options.classes.elementThird),d.innerHTML=options.dateMonths[e.getMonth()],r.classList.add(options.classes.element),r.classList.add(options.classes.elementThird),r.setAttribute("contentEditable",!0),r.addEventListener("input",(t=>{const s=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();let o=t.target.textContent.replace(/^0+/,"").replace(/[^\d]/g,"").slice(0,2);Number(o)>s&&(o=s.toString()),t.target.textContent=o,Number(o)<1&&(o="1"),e.setDate(Number(o))})),r.addEventListener("blur",m),r.innerHTML=e.getDate(),p.classList.add(options.classes.element),p.classList.add(options.classes.elementThird),p.setAttribute("contentEditable",!0),p.addEventListener("input",(t=>{const s=t.target.textContent.replace(/^0+/,"").replace(/[^\d]/g,"").slice(0,4);t.target.textContent=s,e.setFullYear(Number(s))})),p.addEventListener("blur",m),p.innerHTML=e.getFullYear();const D=document.createElement("div");D.classList.add(options.classes.button),D.classList.add(options.classes.elementThird),D.innerHTML=l;const E=document.createElement("div");E.classList.add(options.classes.button),E.classList.add(options.classes.elementThird),E.innerHTML=l;const f=document.createElement("div");f.classList.add(options.classes.button),f.classList.add(options.classes.elementThird),f.innerHTML=l,y.onclick=()=>b(1),C.onclick=()=>v(1),T.onclick=()=>L(1),D.onclick=()=>b(-1),E.onclick=()=>v(-1),f.onclick=()=>L(-1);const M=document.createElement("div");M.classList.add(options.classes.button),M.classList.add(options.classes.elementHalf),M.classList.add(options.classes.backgroundSuccess),M.innerHTML=t,M.onclick=()=>{removeFromDocument(k,a),removeOverlayFromDocument(),o?o(e):i&&i(e)};const F=document.createElement("div");F.classList.add(options.classes.button),F.classList.add(options.classes.elementHalf),F.classList.add(options.classes.backgroundError),F.innerHTML=s,F.onclick=()=>{removeFromDocument(k,a),removeOverlayFromDocument(),n?n(e):c&&c(e)},h.appendChild(y),h.appendChild(C),h.appendChild(T),h.appendChild(d),h.appendChild(r),h.appendChild(p),h.appendChild(D),h.appendChild(E),h.appendChild(f),g.appendChild(h),x.appendChild(g),x.appendChild(M),x.appendChild(F),x.listener=e=>{enterClicked(e)?M.click():escapeClicked(e)&&F.click()},addToDocument(x,a),addOverlayToDocument(x,a)};export default{alert:alert,force:force,confirm:confirm,input:input,select:select,date:date,setOptions:setOptions,hideAlerts:hideAlerts};